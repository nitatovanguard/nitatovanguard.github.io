import{createResizing2dCanvas as e,createFullscreen2dCanvas as t}from"./canvastools.mjs";import{World as n}from"./world.mjs";import{Ant as a}from"./antclass.mjs";import*as o from"./dat.gui.module.mjs";let d;const s={ants:10,foodPhDecayRate:.997,nestPhDecayRate:.997};function r(e){d=new n(e.getWidth(),e.getHeight()),d.initBase(e.getWidth()/2,e.getHeight()/2,s.ants)}function i(e,t){d.update(e),d.draw(e,t)}function h(e){d.resetTargets(),d.setSize(e.getWidth(),e.getHeight())}export function preview(t){const n=document.createElement("canvas");t.appendChild(n),t.style.backgroundColor="moccasin",e(n,t,r,i,h,!0)}export function activate(e){let n;t(e,r,i,h,!0),e.addEventListener("keydown",e=>{e.isComposing||229===e.keyCode||90===e.keyCode&&d.toggleDestinations()}),e.addEventListener("mousedown",()=>{n=!0}),e.addEventListener("mousemove",e=>{!0===n&&d.addFood(e.offsetX,e.offsetY)}),e.addEventListener("mouseup",()=>{!0===n&&(n=!1)}),e.onclick=e=>{d.addFood(e.clientX,e.clientY)};const m=new o.GUI({name:"My GUI"});m.addFolder("Flow Field"),m.add(s,"ants",1,50,1).onChange(e=>d.setNumAnts(e)),m.add(d,"ticksPerFrame",0,1,.01),m.add(s,"foodPhDecayRate",.9,.999,.001).onChange(e=>d.foodph.decayRate=e),m.add(s,"nestPhDecayRate",.9,.999,.001).onChange(e=>d.nestph.decayRate=e),m.add(d.protoAnt,"nestDetectionRange",1,500,1).onChange(()=>d.refreshAntParams()),m.add(d.protoAnt,"foodDetectionRange",1,500,1).onChange(()=>d.refreshAntParams()),m.add(d.protoAnt,"turnSpeed",.001,Math.PI-.01).onChange(()=>d.refreshAntParams()),m.add(d.protoAnt,"viewAngle",.001,Math.PI-.01).onChange(()=>d.refreshAntParams()),m.add(d.protoAnt,"antennaLength",.001,100).onChange(()=>d.refreshAntParams()),m.add(d.protoAnt,"antennaSenseRadius",.01,100).onChange(()=>d.refreshAntParams()),m.add(a,"foodPhDrop",.9,1,.001),m.add(a,"nestPhDrop",.9,1,.001),m.add(d,"showDestinations"),m.add(d,"deletePheromones"),m.add(d,"deleteFood"),m.add(d,"reset")}